{% extends "base.html" %}

{% block title %}Trainer Attendance{% endblock %}

{% block content %}
<div class="container text-center">
    <h1 class="mt-4">Gestione Presenze Trainer</h1>
    <p class="lead">Benvenuto, {{ session.user_name }}</p>
    
    {% if session.user_role == 'trainer' %}
        {% set trainer_sede = get_sede_by_trainer_email(session.user_email) %}
        {% if trainer_sede %}
            <p class="text-muted">Sede principale: {{ trainer_sede.nome }} - {{ trainer_sede.citta }}</p>
            
            {% set sedi_aggiuntive = get_sedi_aggiuntive_trainer(session.user_id, trainer_sede.id) %}
            {% if sedi_aggiuntive|length > 0 %}
                <p class="text-muted">
                    <small>Sedi aggiuntive: 
                        {% for sede_agg in sedi_aggiuntive %}
                            {{ sede_agg.nome }}{% if not loop.last %}, {% endif %}
                        {% endfor %}
                    </small>
                </p>
            {% endif %}
        {% endif %}
    {% endif %}
    
    <div class="mt-4">
        {% if not is_present %}
            <form method="POST" action="{{ url_for('trainers.trainer_entrata') }}">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                <button type="submit" class="btn btn-success btn-lg">Entra</button>
            </form>
        {% else %}
            <form method="POST" action="{{ url_for('trainers.trainer_uscita') }}">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                <button type="submit" class="btn btn-danger btn-lg">Esci</button>
            </form>
        {% endif %}
    </div>
</div>
{% endblock %}